
<html>
	<head>
		<title>Maps on Personalwerk.de</title>

		<link rel="stylesheet" href="leaflet-0.7.3/leaflet.css" />
		<style type="text/css">
			body {
				padding: 0;
				margin: 0;
			}

			.leaflet-container, body {
				background: black;
			}

			#map {
				width: 100%;
				height: 100%;
			}

			.leaflet-control-layers ul {
				padding-left: 22px;
			}

			.leaflet-control-layers ul li {
				cursor: pointer;
			}
		</style>

		<!-- load the leaflet javascript library -->
		<script src="jquery-1.11.3.min.js"></script>
		<script src="leaflet-0.7.3/leaflet.js"></script>
		<script src="leaflet-plugins/Permalink.js"></script>
		<script src="leaflet-plugins/Permalink.Layer.js"></script>
		<script src="leaflet-plugins/Bing.js"></script>

		<script type="text/javascript">
			var attribution = 'Tiles under PD0, Data under OdbL';

			function init()
			{
				var basemap = new L.BingLayer('AgUjrAV3ggamKtrsPI9ruw06v8vStpmRQlQ16te0eLfYKKF6ZLy-MIFx__84B_gQ', {
					maxNativeZoom: 18,
					maxZoom: 20,
					attribution: '',

					opacity: 0.50
				});

				var initial_overlays = ['landuse', 'ways', 'buildings', 'tents', 'noc'];
				var overlays =         ['landuse', 'ways', 'buildings', 'tents', 'noc', 'gpscoords'];
				var layers = [basemap];
				var overlayers = {};
				for (var i = 0; i < overlays.length; i++) {
					var name = overlays[i]
					overlayers[name] = new L.TileLayer('http://campmap.mazdermind.de/tiles/campmap-'+name+'/{z}/{x}/{y}.png', {
						maxZoom: 20,
						attribution: attribution,
						scheme: 'xyz',
						errorTileUrl: 'http://maps.personalwerk.de/404.png'
					});
				};

				for (var i = 0; i < initial_overlays.length; i++) {
					var key = initial_overlays[i];
					layers.push(overlayers[key]);
				};

				var map = new L.Map('map', {
					layers: layers,
					center: new L.LatLng(53.03131, 13.30906),
					zoom: 17,
				});
				window.map = map;

				var layersControl = new L.Control.Layers({}, overlayers, {collapsed: false});
				var permalinkControl = new L.Control.Permalink({layers: layersControl});
				map.addControl(layersControl);
				map.addControl(permalinkControl);

				var scaleControl = new L.Control.Scale();
				map.addControl(scaleControl);

				var $ul = $('<ul>');

				$.each([100, 75, 50, 25, 0], function(idx, opacity) {
					$('<li>').text('Background '+opacity+'%').on('click', function() {
						basemap.setOpacity(opacity/100);
					}).appendTo($ul);
				});

				$('<li>').text('Background White').on('click', function() {
					$('.leaflet-container, body').css('background', 'white');
				}).appendTo($ul);

				$('<li>').text('Background Black').on('click', function() {
					$('.leaflet-container, body').css('background', 'black');
				}).appendTo($ul);

				$('.leaflet-control-layers-list').append([
					'<hr>',
					$ul
				]);
			}
		</script>
	</head>

	<body onload="init();">
		<div id="map"></div>
	</body>
</html>
